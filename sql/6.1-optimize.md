## OPTIMIZE TABLE en MySQL / MariaDB

### 1. Définition

`OPTIMIZE TABLE` est une commande SQL qui permet de **réorganiser et compacter les données d’une table** pour améliorer les performances. Elle est souvent utilisée sur des tables **MyISAM** et **InnoDB**.

---

### 2. Que fait exactement `OPTIMIZE TABLE` ?

**Tables MyISAM** :

* Reconstruit la table et ses index.
* Libère l’espace inutilisé.
* Met à jour les statistiques d’index pour optimiser les requêtes.

**Tables InnoDB** :

* Met à jour les statistiques des index.
* Défragmente les pages de données.
* Libère l’espace libéré par les suppressions de lignes.

---

### 3. À quoi ça sert ?

* Améliorer les performances des requêtes `SELECT`, `INSERT`, `UPDATE`, `DELETE`.
* Libérer de l’espace disque après de nombreuses suppressions ou mises à jour.
* Réparer légèrement les tables si elles contiennent des fragments inutilisés.

---

### 4. Quand l’utiliser ?

* Après beaucoup de suppressions dans une table.
* Après des mises à jour massives de données.
* Sur des tables très volumineuses où les performances de lecture commencent à baisser.
* Pour des tâches de maintenance régulières (par exemple, hebdomadaire ou mensuelle).

---

### 5. Exemple simple

```sql
-- Optimiser une table après une purge massive de données
OPTIMIZE TABLE users;
```

Après exécution :

* L’espace inutilisé est récupéré.
* Les index sont réorganisés.
* Les requêtes sur la table peuvent être plus rapides.

---

### 6. À noter

* `OPTIMIZE TABLE` **verrouille la table** pendant son exécution, donc mieux vaut l’exécuter en dehors des heures de forte utilisation.
* Sur **InnoDB**, la fragmentation n’est souvent pas critique, mais l’optimisation peut aider après de grosses suppressions.
